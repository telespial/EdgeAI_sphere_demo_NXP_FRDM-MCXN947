# Restore Points

This file is an **append-only index** of known-good restore points.

Source of truth:
- Use the git tags listed below to restore code quickly.
- Do not delete old entries. Prefer adding a new tag + a new entry.
- Golden tags are **immutable**: never move an existing `GOLDEN_*` tag. If a new “current golden” is required, create a *new* `GOLDEN_*` tag instead.
- For every golden tag, also create a `GOLDEN_LOCK_*_<SHA>` tag that bakes the target commit SHA into the tag name. Never move lock tags.
- Creating a new golden restore point (new `GOLDEN_*` tag + new entry) requires an explicit project-owner directive in the current session.
- Do not create, move, rename, or "promote" golden tags based on inference, context, or automation defaults.
- Updating "current golden" references elsewhere in the repo (for example, `README.md` and `STATUS.md`) is part of a golden promotion and follows the same authorization rule.
- Maintain an additional file-based failsafe firmware artifact for last-resort board recovery.
  - Pointer file: `docs/failsafe.md` (single artifact filename + a brief state summary).
  - Flash tool: `tools/flash_failsafe.sh` (requires explicit filename confirmation).
  - Updating the failsafe pointer or artifact requires an explicit project-owner directive in the current session.
- Text in docs/comments/scripts must avoid conversational phrasing and direct reader references. See `docs/STYLE_RULES.md`.

## How To Restore
```bash
cd /path/to/EdgeAI_sphere_demo_NXP_FRDM-MCXN947
git fetch --tags
git checkout <TAG>
MCUX_EXAMPLES_DIR="$PWD/mcuxsdk_ws_test/mcuxsdk/examples" ./sdk_example/install_mcux_overlay.sh
ninja -C mcuxsdk_ws_test/build
WS_DIR="$PWD/mcuxsdk_ws_test" ./tools/flash_frdmmcxn947.sh
```

## Restore Points

### 2026-02-08 Golden (Raster Ball + Trails)
- Tag: `GOLDEN_2026-02-08_v9`
- Also: `milestone_raster_flicker_npu_v9`
- Commit: `5d569d4352fc723f6d6d567dcdd3c46f58025fd4`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: tilt-controlled silver ball with shadow + trails (raster renderer)
- Notes: keep this as the baseline restore point if anything breaks.

### 2026-02-08 Environment Walls + Axes (Background Preserved)
- Tag: `milestone_env_walls_axes_v1`
- Commit: `bcdd905e277369efb180a5554b32668e071853c3`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: adds a clipped wireframe “room” (walls + long axes) and updates ball/shadow raster drawing to avoid wiping background lines.
- Notes: this is the restore point to return to if “ball disappears” or walls/axes stop drawing correctly.

### 2026-02-08 No Environment Lines (Ball Only)
- Tag: `milestone_no_env_lines_ball_fix_v1`
- Commit: `a22c521edb6a9f8519ab2d300f5e9b459acdf9b6`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: disables the red/green/blue axis + wall wireframe; keeps black background with the silver ball (+ trails/shadow).
- Notes: use this if the environment overlay is distracting or causes visual artifacts.

### 2026-02-08 Restore Stable (No Env Lines, UART + LCD OK)
- Tag: `milestone_restore_golden_v9_no_env_v1`
- Commit: `fd38f28410ad56ec5d5be149137a90965afde8e5`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: restored back to the stable tilt-ball + trails behavior (no env axes/walls); UART output and LCD rendering verified.
- Notes: use this if the screen goes blank or UART stops printing after experimenting.

### 2026-02-08 Dune Background From Image (Behind Ball)
- Tag: `milestone_dune_bg_v1`
- Commit: `025c2b9780c1b6bca9b56f8f2ad913f3151e6d4c`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: renders a dune background derived from `downloads/sanddune.jpg` behind the ball (single-blit tile renderer).
- Notes: background data lives in `src/dune_bg.h` and is regenerated by `tools/gen_dune_bg.py`.

### 2026-02-08 Dune Background Full-Screen At Boot
- Tag: `milestone_dune_bg_fullscreen_v1`
- Commit: `461b33cbdc4fe67d7a19a15f6a4c7f48f3525b52`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: draws the dune background across the entire screen at boot, then renders ball/trails on top.
- Notes: this removes the “tile reveal” look.

### 2026-02-08 Dune “Reveals As You Roll” (Tile-Only)
- Tag: `milestone_dune_bg_tile_reveal_v1`
- Commit: `fbbf554ec4af8053bf682277255fd7f5510039f9`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: boot stays black; as the ball moves, the dune background is rendered into each dirty-rect tile and remains on-screen.
- Notes: this reverts the fullscreen boot background draw.

### 2026-02-08 Accel Bring-Up Retry + Early Boot Logs
- Tag: `milestone_accel_bringup_retry_v1`
- Commit: `8140a4a0ef7a65c3dbb089c92f0b4b298e1c4e6c`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: initializes LCD early, prints boot banner early, retries accel WHO_AM_I for ~2s, and continues running if accel is missing (so the display doesn’t look “frozen”).
- Notes: if ball is stuck, check UART for `EDGEAI: accel ok addr=0x18` (or 0x19). If “not found” appears, reseat the clickboard / verify I2C mode.
- Correction: older text used second-person wording; meaning is unchanged.

### 2026-02-09 Boot Title “SAND DUNE” (3s Hold)
- Tag: `milestone_boot_title_sand_dune_3s_v1`
- Lock tag: `LOCK_milestone_boot_title_sand_dune_3s_v1_*` (includes SHA in name; do not move)
- Commit: `git rev-parse milestone_boot_title_sand_dune_3s_v1`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: after LCD clears to black at boot, shows “SAND DUNE” centered for ~3 seconds, then clears back to black and proceeds into the normal accel-driven loop.
- Notes: this is intentionally minimal; it does not change the dune “tile reveal” rendering behavior.

### 2026-02-09 Golden (Current): Boot Title “SAND DUNE” (3s Hold)
- Tag: `GOLDEN_2026-02-09_v13_boot_title_3s`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v13_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v13_boot_title_3s`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: same as the boot-title-3s milestone; promoted as the “current golden” due to instability in later experimental goldens.
- Notes: older `GOLDEN_*` tags remain valid restore points; do not overwrite them.

### 2026-02-09 Golden (Current): Docs/Comments Sanitized (No Second-Person Wording)
- Tag: `GOLDEN_2026-02-09_v14_docs_sanitize`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v14_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v14_docs_sanitize`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: same firmware behavior as v13; code/docs updated to remove conversational phrasing and direct references to a reader.
- Notes: this tag is the preferred restore point for continued development.

### 2026-02-09 Golden: Text Style Guardrails
- Tag: `GOLDEN_2026-02-09_v15_style_guardrails`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v15_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v15_style_guardrails`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: no firmware behavior change; adds enforced rules to prevent conversational phrasing in repo text.
- Notes: lint is `./tools/lint_text_style.sh`; optional git hook installer is `./tools/install_git_hooks.sh`.

### 2026-02-09 Golden: NPU Visuals (Experimental)
- Tag: `GOLDEN_2026-02-09_v16_npu_visuals`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v16_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v16_npu_visuals`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: attempts to use NPU output as a visual modulation input (experimental).
- Notes: restore to v15 if boot stability regresses.

### 2026-02-09 Golden: Docs Sync (Reference Pointers Updated)
- Tag: `GOLDEN_2026-02-09_v17_docs_sync_v15`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v17_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v17_docs_sync_v15`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: no firmware behavior change; doc pointers updated for consistency.
- Notes: this exists to preserve a known docs state.

### 2026-02-09 Golden: Status Overlay (Upper Right)
- Tag: `GOLDEN_2026-02-09_v18_status_overlay`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v18_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v18_status_overlay`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: adds a tiny blue status overlay in the upper-right (CPU FPS + NPU init/inference flags).
- Notes: revert if overlay obscures content.

### 2026-02-09 Golden (Current): Boot Stable After Title (NPU Init Guarded)
- Tag: `GOLDEN_2026-02-09_v19_boot_stable_after_title`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v19_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v19_boot_stable_after_title`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: avoids a post-title black-screen freeze by gating NPU model init behind `EDGEAI_ENABLE_NPU_INFERENCE`.
- Notes: keep `EDGEAI_ENABLE_NPU_INFERENCE=0` unless the model init path is verified stable on the connected board.

### 2026-02-09 Golden (Current): Architecture Refactor (Sim/Render/NPU Boundaries)
- Tag: `GOLDEN_2026-02-09_v20_arch_refactor`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v20_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v20_arch_refactor`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: refactors the demo into explicit accel processing, simulation step, world rendering, and NPU backend modules.
- Notes: NPU backend selection is compile-time (`EDGEAI_NPU_BACKEND`); NPU stepping remains gated behind `EDGEAI_ENABLE_NPU_INFERENCE`.

### 2026-02-09 Golden (Current): HUD Backend + Glyph Coverage
- Tag: `GOLDEN_2026-02-09_v21_hud_backend_glyphs`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v21_a7ebef3` (includes SHA in name; do not move)
- Commit: `a7ebef3b2697bce0b3cd6008e11b26c2ca6d4310`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: preserves the dune background + tilt ball demo and adds a stable HUD renderer path (upper-right text) with expanded 5x7 glyph coverage.
- Notes: baseline restore point for continued work; do not move this tag or its lock.

### 2026-02-09 Golden (Current): Ball Polish Base (Docs + Tooling Synced)
- Tag: `GOLDEN_2026-02-09_v22_ball_polish_base`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v22_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v22_ball_polish_base`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: same firmware behavior as v21; docs updated with a ToDo plan and tooling updated to support explicit build/flash directories.
- Notes: baseline for implementing A1-A4 ball polish tasks; do not move this tag or its lock.

### 2026-02-09 Golden (Current): Ball Polish A1-A4 (Background + Bounds + Trails + Bang)
- Tag: `GOLDEN_2026-02-09_v23_ball_polish_a1_a4`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v23_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v23_ball_polish_a1_a4`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: draws full dune background after title; bounce bounds match perspective radius; no stuck trail dots when dirty-rect clamps; table taps produce a visible velocity kick; per-second timing instrumentation enabled.
- Notes: this is the preferred restore point for continued work on the sandbox demo.

### 2026-02-09 Golden (Current): 3D Lift (Vertical Motion Depth Cue)
- Tag: `GOLDEN_2026-02-09_v24_3d_lift_motion`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v24_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v24_3d_lift_motion`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: adds a third-dimension depth cue. The ball lifts up/down relative to its shadow based on vertical motion (accel magnitude high-pass). Ball size and shadow intensity vary with lift; UART debug includes `gmag`, `ghp`, and `lift`.
- Notes: stable baseline for continuing NPU post-process and gesture work.

### 2026-02-09 Golden (Current): Roll Speed Limit (Render-Stable)
- Tag: `GOLDEN_2026-02-09_v25_roll_speed_limit`
- Lock tag: `GOLDEN_LOCK_2026-02-09_v25_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-09_v25_roll_speed_limit`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: same as v24, with ~10% reduced max tilt acceleration to keep rendering stable at high roll speeds.
- Notes: preferred restore point for starting NPU post-process work.

### 2026-02-10 Golden (Current): Ball Reflections + Moving Sparkles (Spin Shimmer)
- Tag: `GOLDEN_2026-02-10_v26_ball_reflections_sparkles`
- Lock tag: `GOLDEN_LOCK_2026-02-10_v26_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-10_v26_ball_reflections_sparkles`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: replaces the static 45-degree streak highlight with a rolling environment reflection (sky/ground + sun spot) and moving sparkles driven by an approximate spin phase accumulator. NPU path remains optional and gated.
- Notes: NPU-enabled builds require a larger stack (`__stack_size__=0x2000`) to avoid STKOF HardFault during TFLM/Neutron init/invoke.

### 2026-02-10 Golden (Current): NPU Glint (Inference Enabled, Neutron)
- Tag: `GOLDEN_2026-02-10_v27_npu_glint`
- Lock tag: `GOLDEN_LOCK_2026-02-10_v27_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-10_v27_npu_glint`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: tilt-controlled silver ball demo with dune background, HUD status, and NPU inference enabled to drive glint modulation.
- Build: `-DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`
- Example build (debug): `west build -d build_v27_npu_glint mcuxsdk/examples/demo_apps/edgeai_sand_demo --toolchain armgcc --config debug -b frdmmcxn947 -Dcore_id=cm33_core0 -DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`

### 2026-02-14 Golden (Current): GitHub Pull Baseline + Failsafe Sync
- Tag: `GOLDEN_2026-02-14_v28_github_pull_baseline`
- Lock tag: `GOLDEN_LOCK_2026-02-14_v28_*` (includes SHA in name; do not move)
- Commit: `git rev-parse GOLDEN_2026-02-14_v28_github_pull_baseline`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: same runtime behavior as v27 NPU glint golden; promoted so GitHub default pull target, golden tag, and failsafe pointer all align.
- Failsafe pointer: `docs/failsafe.md` -> `bad_builds/FAILSAFE_2026-02-14_v28_from_v27_7bab699.elf` (archived)
- Build: `-DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`

### 2026-02-14 Golden (Current): Restore v27 Exact Working Image
- Tag: `GOLDEN_2026-02-14_v29_restore_v27_exact`
- Lock tag: `GOLDEN_LOCK_2026-02-14_v29_*` (includes SHA in name; do not move)
- Commit: `7bab69912abc2de358ceaa6b897fa8fce143de32`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: exact working runtime restored from v27 (NPU glint enabled build).
- Failsafe pointer: `docs/failsafe.md` -> `bad_builds/FAILSAFE_2026-02-14_v29_restore_v27_exact_7bab699.elf` (archived)
- Build: `-DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`
- Notes: use this entry for recovery if newer promoted states regress behavior.

### 2026-02-14 Golden: Working Runtime Relock (Archived)
- Tag: `GOLDEN_2026-02-14_v30_working_relock`
- Lock tag: `GOLDEN_LOCK_2026-02-14_v30_*` (includes SHA in name; do not move)
- Commit: `b545bc7c700bf9871e55f9b8425f6b6b7c711333`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: working runtime relocked after restoring render path to failsafe baseline; board verified operational again.
- Failsafe pointer: `docs/failsafe.md` -> `bad_builds/FAILSAFE_2026-02-14_v30_main_b545bc7.elf` (archived)
- Build: `BUILD_DIR="$PWD/mcuxsdk_ws/build_main_safe" ./tools/build_frdmmcxn947.sh`
- Notes: archived after hardware regression reports; active failsafe pointer was reverted to v29.

### 2026-02-14 Golden (Current): HUD Top-Left + Startup Visibility
- Tag: `GOLDEN_2026-02-14_v31_hud_top_left_boot_visible`
- Lock tag: `GOLDEN_LOCK_2026-02-14_v31_4b59071` (includes SHA in name; do not move)
- Commit: `4b590716c2818e98d865f3719a8d1e3ee5331cfe`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: keeps the v27 NPU glint path and moves the blue status HUD to top-left. HUD rendering is decoupled from ball dirty-rect updates so status text is visible immediately after startup background draw.
- Build: `-DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`
- Example build (debug): `west build -d build_v27_exact_flags mcuxsdk/examples/demo_apps/edgeai_sand_demo --toolchain armgcc --config debug -b frdmmcxn947 -Dcore_id=cm33_core0 -DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`
- Failsafe artifact: `failsafe/FAILSAFE_2026-02-14_v31_hud_top_left_boot_visible_4b59071.elf`

### 2026-02-14 Golden (Current): Signature Full Name + Glyph Completion
- Tag: `GOLDEN_2026-02-14_v32_signature_full_name`
- Lock tag: `GOLDEN_LOCK_2026-02-14_v32_1983041` (includes SHA in name; do not move)
- Commit: `19830418466bd5041d9d6fbc636bac8803df1254`
- Hardware: FRDM-MCXN947 + PAR-LCD-S035 + Accel 4 Click (FXLS8974CF over mikroBUS/I2C)
- Behavior: keeps v31 behavior (HUD top-left startup visibility) and adds persistent top-right signature text `(c)RICHARD HABERKERN` with complete glyph coverage so all letters render.
- Build: `-DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`
- Example build (debug): `west build -d build_v27_exact_flags mcuxsdk/examples/demo_apps/edgeai_sand_demo --toolchain armgcc --config debug -b frdmmcxn947 -Dcore_id=cm33_core0 -DEDGEAI_ENABLE_NPU_INFERENCE=1 -DEDGEAI_NPU_BACKEND=1`
- Failsafe artifact: `failsafe/FAILSAFE_2026-02-14_v32_signature_full_name_1983041.elf`

## Template (Copy/Paste)
### YYYY-MM-DD Short Name
- Tag: `TAG_NAME`
- Commit: `FULL_SHA1`
- Hardware:
- Behavior:
- Notes:
